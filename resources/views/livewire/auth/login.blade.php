<?php
use Livewire\Volt\Component;
use App\Models\User;
use App\Models\Role;
use App\Providers\RouteServiceProvider;
use Illuminate\Support\Facades\Hash;
use Illuminate\Support\Facades\Auth;
use Illuminate\Support\Str;



new Class extends Component {

    public $email;
    public $password;
    public $messageError;


    public function login(){
        $this->validate([
                'email' => ['required', 'string', 'email'],
                'password' => ['required',],
            ],[
                'email.required' => 'L\'adresse Email est obligatoire',
                'password.required' => 'Le mot de passe est obligatoire',
                'email.email' => 'Email n\'est pas valide',
                'email.string' => 'Email n\'est pas valide',
            ]);


            if($this->email){
                $user = User::where('email', $this->email)->first();
            }elseif($this->phone){
                $user = User::where('phone', $this->phone)->first();
            }

            if(!$user){
                $this->messageError = "Ce compte n'existe pas !!";
                return false;
            }

            if (auth('web')->attempt(['email' => $this->email, 'password' => $this->password])) {
                // Log
                // ActivityLog("Connexion via email et mot de passe", "Admin");

                return  redirect()->route('dashboard.home');
            }else{
                $this->messageError = "Les informations que vous avez entrez ne correspondent pas !!";
            }
    }

    public function with(): array
    {
        return [

        ];
    }
}

?>



 <!-- auth-page content -->
 <div class="auth-page-content overflow-hidden pt-lg-5">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="card overflow-hidden">
                    <div class="row g-0">
                        <div class="col-lg-6">
                            <div class="p-lg-5 p-4 auth-one-bg h-100">
                                <div class="bg-overlay"></div>
                                <div class="position-relative h-100 d-flex flex-column">
                                    <div class="mb-4">
                                        <a href="/" class="d-block">
                                            <svg width="155" height="41" viewBox="0 0 155 41" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M18.3168 0.197454C21.2745 0.197454 23.8097 0.767873 25.9224 1.90871C28.0773 3.04955 29.8519 4.54954 31.2463 6.40868C32.6406 8.26782 33.6547 10.4016 34.2885 12.81C34.9223 15.1762 35.1969 17.6058 35.1124 20.0987C35.0702 22.5917 34.6688 25.0424 33.9082 27.4508C33.1477 29.817 32.0491 31.9296 30.6125 33.7888C29.2181 35.6479 27.4857 37.1479 25.4153 38.2887C23.3872 39.4296 21.0421 40 18.3802 40C15.3379 40 12.6971 39.4296 10.4577 38.2887C8.21825 37.1479 6.35911 35.6479 4.88025 33.7888C3.44364 31.9296 2.36618 29.817 1.64788 27.4508C0.929571 25.0424 0.591545 22.5917 0.633799 20.0987C0.676052 17.6058 1.07746 15.1762 1.83802 12.81C2.59857 10.4016 3.71828 8.26782 5.19715 6.40868C6.67601 4.54954 8.51403 3.04955 10.7112 1.90871C12.9084 0.767873 15.4436 0.197454 18.3168 0.197454ZM18.3168 2.35237C16.9647 2.35237 15.7816 2.85941 14.7675 3.87348C13.7534 4.88756 12.8872 6.23967 12.1689 7.92979C11.4929 9.57767 10.9647 11.4791 10.5844 13.634C10.2464 15.7466 10.0774 17.9227 10.0774 20.1621C10.0774 22.3593 10.2253 24.5142 10.5211 26.6269C10.8591 28.7395 11.3661 30.6409 12.0422 32.331C12.7182 33.9789 13.5633 35.3099 14.5774 36.324C15.6337 37.338 16.859 37.8451 18.2534 37.8451C19.521 37.8451 20.6196 37.338 21.5491 36.324C22.4787 35.3099 23.2393 33.9789 23.8308 32.331C24.4646 30.6409 24.9083 28.7395 25.1618 26.6269C25.4576 24.5142 25.5843 22.3593 25.5421 20.1621C25.5421 17.9227 25.3731 15.7466 25.035 13.634C24.697 11.4791 24.2111 9.57767 23.5773 7.92979C22.9858 6.23967 22.2463 4.88756 21.359 3.87348C20.4717 2.85941 19.4576 2.35237 18.3168 2.35237ZM63.469 38.7958L63.5324 40H52.124C52.124 39.662 51.8916 39.493 51.4268 39.493C50.962 39.4507 50.3916
                                                 39.493 49.7156 39.6197C49.0818 39.7465 48.4057 39.8732 47.6874 40C46.9691 40.169 46.3353 40.2535 45.786 40.2535C43.8846 40.2535 42.279 40.0423 40.9691 39.6197C39.7015 39.1549 38.6663 38.4578 37.8635 37.5282C37.103 36.5986 36.5537 35.4578 36.2156 34.1057C35.9199 32.7536 35.772 31.1479 35.772 29.2888C35.772 28.1057 35.772 26.6057 35.772 24.7888C35.772 22.9719 35.6875 21.1762 35.5185 19.4015C35.3917 17.5847 35.1593 15.979 34.8213 14.5847C34.4833 13.1903 33.9762 12.3453 33.3002 12.0495V10.6551H46.4198V11.8593C45.955 12.1129 45.4902 12.9368 45.0254 14.3312C44.5607 15.7255 44.1593 17.3945 43.8212 19.3382C43.4832 21.2396 43.2719 23.2677 43.1874 25.4226C43.1452 27.5775 43.2719 29.5846 43.5677 31.4437C43.8635 33.2606 44.4128 34.7817 45.2156 36.0071C46.0184 37.1902 47.1381 37.7817 48.5747 37.7817C49.7156 37.7817 50.624 37.2113 51.3 36.0704C51.9761 34.8874 52.462 33.4085 52.7578 31.6339C53.0536 29.817 53.1592 27.8522 53.0747 25.7395C53.0324 23.5846 52.8634 21.5565 52.5676 19.6551C52.3141 17.7114 51.955 16.0424 51.4902 14.6481C51.0677 13.2114 50.5817 12.303 50.0325 11.9227V10.6551H60.9972C60.9972 11.8382 60.9972 13.296 60.9972 15.0283C60.9972 16.7607 61.0183 18.5987 61.0605 20.5424C61.1028 22.486 61.1662 24.4508 61.2507 26.4367C61.3774 28.4226 61.5253 30.2606 61.6943 31.9508C61.8634 33.6409 62.0957 35.0986 62.3915 36.324C62.6873 37.5493 63.0464 38.3733 63.469 38.7958ZM72.6016 0.260833C72.6016 1.35942 72.6016 2.81715 72.6016 4.63404C72.6016 6.40868 72.6016 8.41571 72.6016 10.6551C72.6016 12.8523 72.6227 15.1551 72.665 17.5635C72.7073 19.972 72.7706 22.317 72.8551 24.5987C75.0101 22.0212 76.9326 19.6551 78.6227 17.5002C80.3128 15.3452 82.1086
                                                  13.4861 84.01 11.9227C85.2776 10.9086 86.8198 10.0425 88.6367 9.32415C90.4536 8.56359 92.3761 8.03543 94.4043 7.73966C96.4324 7.40163 98.4817 7.296 100.552 7.42276C102.623 7.50726 104.545 7.88754 106.32 8.56359C108.094 9.19739 109.637 10.1692 110.946 11.4791C112.299 12.7467 113.228 14.3734 113.735 16.3593C113.989 17.3734 114.137 18.5987 114.179 20.0353C114.263 21.472 114.327 22.9931 114.369 24.5987C114.411 26.1621 114.453 27.7466 114.496 29.3522C114.538 30.9578 114.665 32.4367 114.876 33.7888C115.129 35.0986 115.468 36.2183 115.89 37.1479C116.355 38.0775 117.01 38.6479 117.855 38.8592L117.918 40H109.045C108.707 39.1127 108.369 38.6268 108.031 38.5423C107.693 38.4578 107.228 38.5423 106.637 38.7958C106.045 39.0493 105.263 39.3662 104.292 39.7465C103.32 40.1268 102.01 40.3169 100.362 40.3169C97.362 40.3169 95.0592 39.7887 93.4536 38.7324C91.8902 37.6761 90.8973 36.3662 90.4747 34.8029C90.0945 33.1972 90.2001 31.486 90.7916 29.6691C91.4254 27.8099 92.4606 26.0987 93.8972 24.5353C95.3339 22.9297 97.0874 21.5987 99.1578 20.5424C101.27 19.4861 103.594 18.9579 106.13 18.9579C106.13 16.2959 105.348 14.2044 103.785 12.6833C102.221 11.1199 100.108 10.3382 97.4465 10.3382C95.2494 10.3382 93.2634 10.7185 91.4888 11.4791C89.7142 12.1974 88.0874 13.1269 86.6086 14.2678C85.172 15.4086 83.8621 16.6762 82.679 18.0706C81.4959 19.4227 80.3973 20.7325 79.3833 22.0001C80.1861 23.2255 81.1156 24.7043 82.172 26.4367C83.2283 28.1268 84.3269 29.817 85.4677 31.5071C86.6086 33.155 87.7283 34.6761 88.8269 36.0704C89.9677 37.4226 90.9818 38.3521 91.8691 38.8592L91.9325 40H77.4185L77.3551 38.8592C77.8199 38.3944 77.9467 37.6549 77.7354 36.6409C77.5241 35.5845
                                                   77.1438 34.4226 76.5945 33.155C76.0875 31.8874 75.4748 30.6198 74.7565 29.3522C74.0805 28.0423 73.4678 26.9226 72.9185 25.9931C73.003 27.6832 73.1087 29.2677 73.2354 30.7465C73.3622 32.2254 73.5101 33.5353 73.6791 34.6761C73.8481 35.8169 74.0382 36.7676 74.2495 37.5282C74.503 38.2465 74.7777 38.6901 75.0734 38.8592L75.1368 40H61.6369L61.5735 38.8592C62.2496 38.2676 62.82 37.0211 63.2848 35.1198C63.7496 33.1761 64.0876 30.9156 64.2989 28.3381C64.5524 25.7184 64.6791 22.9508 64.6791 20.0353C64.6791 17.0776 64.5524 14.31 64.2989 11.7326C64.0876 9.15514 63.7496 6.93684 63.2848 5.0777C62.82 3.17631 62.2496 1.97209 61.5735 1.46505V0.260833H72.6016ZM106.13 21.1128C104.946 21.1128 103.911 21.5776 103.024 22.5072C102.179 23.4367 101.461 24.5353 100.869 25.8029C100.32 27.0705 99.8972 28.3592 99.6014 29.6691C99.3479 30.9367 99.2212 31.9296 99.2212 32.6479C99.2212 33.5353 99.3902 34.4014 99.7282 35.2465C100.108 36.0916 100.594 36.7676 101.186 37.2747C101.82 37.7395 102.559 37.9507 103.404 37.9085C104.249 37.8662 105.158 37.4014 106.13 36.5141V21.1128ZM126.931 0.260833C126.931 1.57068 126.931 3.38757 126.931 5.7115C126.931 8.03543 126.931 10.5917 126.931 13.3805C126.973 16.1269 127.037 18.9579 127.121 21.8734C127.206 24.7466 127.332 27.4085 127.501 29.8592C127.713 32.2677 127.966 34.2958 128.262 35.9437C128.558 37.5916 128.938 38.5423 129.403 38.7958L129.466 40H116.03L115.966 38.7958C116.642 38.2042 117.192 36.9578 117.614 35.0564C118.079 33.1127 118.417 30.8522 118.628 28.2747C118.882 25.655 119.009 22.8874 119.009 19.972C119.009 17.0565 118.903 14.31 118.692 11.7326C118.48 9.15514 118.142 6.93684 117.678 5.0777C117.213 3.17631 116.642 1.97209
                                                    115.966 1.46505V0.260833H126.931ZM154.528 31.5071C153.767 33.6198 152.563 35.3733 150.915 36.7676C149.267 38.1197 147.451 39.0916 145.465 39.6831C143.479 40.2324 141.408 40.3803 139.253 40.1268C137.141 39.9155 135.218 39.3028 133.486 38.2887C131.753 37.2324 130.317 35.7747 129.176 33.9155C128.077 32.0141 127.528 29.6902 127.528 26.9438C127.528 24.8733 127.845 22.8663 128.479 20.9227C129.155 18.9368 130.127 17.1833 131.394 15.6621C132.704 14.141 134.31 12.9157 136.211 11.9861C138.113 11.0565 140.289 10.5917 142.739 10.5917C144.641 10.5917 146.267 10.8664 147.62 11.4157C148.972 11.965 150.07 12.6833 150.915 13.5706C151.803 14.4579 152.479 15.472 152.943 16.6128C153.451 17.7537 153.831 18.9156 154.084 20.0987C154.338 21.2396 154.486 22.3593 154.528 23.4579C154.57 24.5142 154.591 25.4438 154.591 26.2466H135.451C135.535 27.4297 135.958 28.5494 136.718 29.6057C137.479 30.662 138.43 31.5705 139.57 32.331C140.711 33.0916 141.958 33.6831 143.31 34.1057C144.704 34.486 146.035 34.6338 147.303 34.5493C148.613 34.4648 149.796 34.1268 150.852 33.5353C151.951 32.9015 152.774 31.9296 153.324 30.6198L154.528 31.5071ZM135.451 24.0917C135.958 24.0917 136.528 24.0917 137.162 24.0917C137.838 24.0494 138.535 24.0283 139.253 24.0283C139.972 23.986 140.69 23.9438 141.408 23.9015C142.169 23.817 142.887 23.7114 143.563 23.5846C145 23.3734 146.056 22.9508 146.732 22.317C147.451 21.6832 147.873 20.9649 148 20.1621C148.169 19.3593 148.063 18.5354 147.683 17.6903C147.345 16.803 146.838 16.0002 146.162 15.2819C145.486 14.5213 144.683 13.9086 143.753 13.4438C142.824 12.9791 141.852 12.7467 140.838 12.7467C140.162 12.7467 139.507 13.0002 138.873 13.5072C138.239 13.972 137.669 14.6903 137.162 15.6621C136.655 16.5917 136.232 17.7748 135.894 19.2114C135.599 20.6058 135.451 22.2325 135.451 24.0917Z" fill="#FF00FF"/>
                                            </svg>
                                        </a>
                                    </div>
                                    <div class="mt-auto">
                                        <div class="mb-3">
                                            <i class="ri-double-quotes-l display-4 text-success"></i>
                                        </div>

                                        <div id="qoutescarouselIndicators" class="carousel slide" data-bs-ride="carousel">
                                            <div class="carousel-indicators">
                                                <button type="button" data-bs-target="#qoutescarouselIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                                                <button type="button" data-bs-target="#qoutescarouselIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
                                                <button type="button" data-bs-target="#qoutescarouselIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
                                            </div>
                                            <div class="carousel-inner text-center text-white-50 pb-5">
                                                <div class="carousel-item active">
                                                    <p class="fs-15 fst-italic">" Profitez d'un accès privilégié à votre tableau de bord d'administration! "</p>
                                                </div>
                                                <div class="carousel-item">
                                                    <p class="fs-15 fst-italic">" gérer efficacement les tâches et les données en temps réel."</p>
                                                </div>
                                                <div class="carousel-item">
                                                    <p class="fs-15 fst-italic">" Accédez à toutes les informations nécessaires pour prendre des décisions rapides et assurer le bon fonctionnement de votre système! "</p>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- end carousel -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- end col -->

                        <div class="col-lg-6">
                            <div class="p-lg-5 p-4">
                                <div>
                                    <h5 class="text-primary">De retour sur OUKALE !</h5>
                                    <p class="text-muted mb-4">Connectez-vous pour continuer sur OUKALE</p>

                                    @if ($messageError)
                                        <div class="alert alert-danger">
                                            <p>{{ $messageError }}</p>
                                        </div>
                                    @endif

                                </div>

                                <div class="mt-4">
                                    <form wire:submit.prevent="login">
                                        @csrf

                                        <div class="mb-3">
                                            <label for="email" class="form-label">Email</label>
                                            <input type="email" class="form-control" wire:model="email" id="email" placeholder="Entrer votre addresse email...">
                                            @error('email')
                                                <span class="feedback-text">
                                                    {{ $message }}
                                                </span>
                                            @enderror
                                        </div>

                                        <div class="mb-3">
                                            <div class="float-end">
                                                <a href="auth-pass-reset-cover.html" class="text-muted">mot de passe oublié?</a>
                                            </div>
                                            <label class="form-label" for="password-input">Mot de passe</label>
                                            <div class="position-relative auth-pass-inputgroup mb-3">
                                                <input type="password" wire:model="password" class="form-control pe-5 password-input" placeholder="Enter password" id="password-input">
                                                <button class="btn btn-link position-absolute end-0 top-0 text-decoration-none text-muted password-addon" type="button" id="password-addon"><i class="ri-eye-fill align-middle"></i></button>
                                                @error('password')
                                                <span class="feedback-text">
                                                    {{ $message }}
                                                </span>
                                            @enderror
                                            </div>
                                        </div>

                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="" id="auth-remember-check">
                                            <label class="form-check-label" for="auth-remember-check">se souvenir de moi</label>
                                        </div>

                                        <div class="mt-4">
                                            <button class="btn btn-success w-100" type="submit">Connexion</button>
                                        </div>

                                        <div class="mt-4 text-center">
                                            <div class="signin-other-title">
                                                <h5 class="fs-13 mb-4 title"><a href="auth-signup-cover.html" class="fw-semibold text-primary text-decoration-underline"> Rénitialiser mon mot de passe</a></h5>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <!-- end col -->
                    </div>
                    <!-- end row -->
                </div>
                <!-- end card -->
            </div>
            <!-- end col -->

        </div>
        <!-- end row -->
    </div>
    <!-- end container -->
</div>
<!-- end auth page content -->

@push('styles')
    <style>
        .feedback-text{
            width: 100%;
            margin-top: .25rem;
            font-size: .875em;
            color: #f06548;
        }
    </style>
@endpush
